General flow\+:


\begin{DoxyEnumerate}
\item load input data (cross sections, simulation config)
\item initialize simulation runtime
\begin{DoxyItemize}
\item pre-\/allocate memory for particle histories
\item precompute needed stuff
\end{DoxyItemize}
\item run particle history simulation, save the history
\item calculate tallies over the particle histories
\item save data
\end{DoxyEnumerate}\hypertarget{md_docs_01_simulation_principle_autotoc_md12}{}\doxysection{Single particle simulation}\label{md_docs_01_simulation_principle_autotoc_md12}

\begin{DoxyEnumerate}
\item Sample the volume to create particle origin
\begin{DoxyItemize}
\item sample PRNG for position
\item only done once for each particle
\end{DoxyItemize}
\item Calculate distance to next collision
\begin{DoxyItemize}
\item exponentional function
\item check if we crossed surface boundary and possibly reflect back
\item if we cross a boundary, calculate a new distance
\end{DoxyItemize}
\item Determine volume, sample crosssections
\item Calculate interactions
\item Modify particle values, save to particle history
\item Repeat from 1. unless we reach max particle stack size, energy cutoff threshold or total particle absorption
\end{DoxyEnumerate}\hypertarget{md_docs_01_simulation_principle_autotoc_md13}{}\doxysection{Interactions calculation}\label{md_docs_01_simulation_principle_autotoc_md13}

\begin{DoxyItemize}
\item calculate total crossection value
\item sample uniform random variable between 0 and total crosssection
\item determine interaction
\end{DoxyItemize}\hypertarget{md_docs_01_simulation_principle_autotoc_md14}{}\doxysubsection{Photoeletric Absorption}\label{md_docs_01_simulation_principle_autotoc_md14}

\begin{DoxyItemize}
\item as we do not care about secondary particles, the photon just gets stopped/absorbed
\end{DoxyItemize}\hypertarget{md_docs_01_simulation_principle_autotoc_md15}{}\doxysubsection{Coherent Scattering (\+Rayleigh)}\label{md_docs_01_simulation_principle_autotoc_md15}

\begin{DoxyItemize}
\item TODO\+: write this
\end{DoxyItemize}\hypertarget{md_docs_01_simulation_principle_autotoc_md16}{}\doxysubsection{Incoherent Scattering (\+Compton)}\label{md_docs_01_simulation_principle_autotoc_md16}

\begin{DoxyItemize}
\item TODO\+: write this
\end{DoxyItemize}\hypertarget{md_docs_01_simulation_principle_autotoc_md17}{}\doxysubsection{Pair Production}\label{md_docs_01_simulation_principle_autotoc_md17}

\begin{DoxyItemize}
\item as we do not care about secondary particles, the photon just gets stopped/absorbed 
\end{DoxyItemize}